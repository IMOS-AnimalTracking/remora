<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>extractBlue • remora</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="extractBlue">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">remora</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="">0.9.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"></ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/shinyReport_transmitters.html">shinyReport_transmitters</a>
    </li>
    <li>
      <a href="../articles/shinyReport_receivers.html">shinyReport_receivers</a>
    </li>
    <li>
      <a href="../articles/runQC.html">runQC</a>
    </li>
    <li>
      <a href="../articles/extractEnv.html">extractEnv</a>
    </li>
    <li>
      <a href="../articles/extractBlue.html">extractBlue</a>
    </li>
    <li>
      <a href="../articles/extractMoor.html">extractMoor</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/IMOS-AnimalTracking/remora" class="external-link">
    <span class="fa fa-github fa-lg"></span>

    GitHub
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="extractBlue_files/kePrint-0.0.1/kePrint.js"></script><link href="extractBlue_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>extractBlue</h1>
            <h3 data-toc-skip class="subtitle">Integrating Bluelink
(BRAN) environmental data with animal locations</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/IMOS-AnimalTracking/remora/blob/main/vignettes/extractBlue.Rmd" class="external-link"><code>vignettes/extractBlue.Rmd</code></a></small>
      <div class="hidden name"><code>extractBlue.Rmd</code></div>

    </div>

    
    
<hr>
<p>This functionality of the <code>remora</code> package allows users to
integrate acoustic telemetry data and <a href="https://research.csiro.au/bluelink/" class="external-link">Bluelink Reanalysis
(BRAN)</a> environmental data. Since this is a reanalysis data with
10-km spatial resolution, the user will benefit from a dataset with
daily resolution and no gaps, which are common in remotely sensed data
due to cloud cover. Again, we advocate for users to first undertake a
quality control step using the <code><a href="../reference/runQC.html">runQC()</a></code> function and
workflow before further analysis (see <code><a href="../articles/runQC.html">vignette('runQC')</a></code>),
however the functionality to append Bluelink (BRAN) environmental data
will work on any dataset that has at the minimum spatial coordinates and
a timestamp for each detection event. A benefit of using Bluelink (BRAN)
data in your analyses of animal movements is that data can be obtained
in <em>3D</em>, ranging from the ocean surface all the way to 4,509 m in
depth.</p>
<p>The <code><a href="../reference/extractBlue.html">extractBlue()</a></code> function can be used to obtain
environmental data <strong>anywhere in the world</strong>.</p>
<center>
<div class="float" id="id">
<img src="images/bluelink/Bluelink_ex.png" class="class" style="width:100.0%" alt="Example of Bluelink (BRAN) water temperature data at the surface on 1 January 2013 showing its global coverage"><div class="figcaption">Example of Bluelink (BRAN) water temperature
data at the surface on 1 January 2013 showing its global coverage</div>
</div>
</center>
<p><br></p>
<div class="section level2">
<h2 id="types-of-environmental-data">Types of environmental data<a class="anchor" aria-label="anchor" href="#types-of-environmental-data"></a>
</h2>
<p>This function allows users to download and process a range of daily
oceanographic variables (between 1993 - present) housed within the <a href="https://research.csiro.au/bluelink/outputs/data-access/data-formats/" class="external-link">Bluelink
(BRAN)</a>. Information about the Bluelink (BRAN) variables currently
avaiable for download using <code>remora</code> can be found using
<code><a href="../reference/imos_variables.html">imos_variables()</a></code>. These datasets can also be manually
downloaded with daily, weekly or annual resolutions through the <a href="https://dapds00.nci.org.au/thredds/catalog/gb6/BRAN/BRAN2020/catalog.html" class="external-link">NCI
portal</a>.</p>
<p><br></p>
<p>Variables include current speed at both horizontal (in both x (u) and
y (v) directions) and vertical planes (i.e. <code>ocean_w</code> will
provide data on current speed in the vertical plane), and other
environmental variables at depths ranging between the ocean surface to
4,905 m.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/IMOS-AnimalTracking/remora/" class="external-link">remora</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/imos_variables.html">imos_variables</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-paper" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:left;">
Platform
</th>
<th style="text-align:left;">
Temporal resolution
</th>
<th style="text-align:left;">
Units
</th>
<th style="text-align:left;">
Function to use
</th>
<th style="text-align:left;">
Description
</th>
<th style="text-align:left;">
Source
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
bathy
</td>
<td style="text-align:left;">
Composite raster product
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
meters
</td>
<td style="text-align:left;">
extractEnv()
</td>
<td style="text-align:left;width: 30em; ">
Australian Bathymetry and Topography Grid. 250 m resolution.
</td>
<td style="text-align:left;">
Geosciences Australia
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
dist_to_land
</td>
<td style="text-align:left;">
Raster product
</td>
<td style="text-align:left;">
<ul><li></ul>
</td>
<td style="text-align:left;">
kilometers
</td>
<td style="text-align:left;">
extractEnv()
</td>
<td style="text-align:left;width: 30em; ">
Distance from nearest shoreline (in km). Derived from the
high-resolution Open Street Map shoreline product.
</td>
<td style="text-align:left;">
This package
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
rs_sst
</td>
<td style="text-align:left;">
Satellite-derived raster product
</td>
<td style="text-align:left;">
daily (2002-07-04 - present)
</td>
<td style="text-align:left;">
degrees Celcius
</td>
<td style="text-align:left;">
extractEnv()
</td>
<td style="text-align:left;width: 30em; ">
1-day multi-swath multi-sensor (L3S) remotely sensed sea surface
temperature (degrees Celcius) at 2 km resolution. Derived from the Group
for High Resolution Sea Surface Temperature (GHRSST)
</td>
<td style="text-align:left;">
IMOS
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
rs_sst_interpolated
</td>
<td style="text-align:left;">
Raster product
</td>
<td style="text-align:left;">
daily (2006-06-12 - present)
</td>
<td style="text-align:left;">
degrees Celcius
</td>
<td style="text-align:left;">
extractEnv()
</td>
<td style="text-align:left;width: 30em; ">
1-day interpolated remotely sensed sea surface temperature (degrees
Celcius) at 9 km resolution. Derived from the Regional Australian
Multi-Sensor Sea surface temperature Analysis (RAMSSA, Beggs et
al. 2010) system as part of the BLUElink Ocean Forecasting Australia
project
</td>
<td style="text-align:left;">
IMOS
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
rs_chl
</td>
<td style="text-align:left;">
Satellite-derived raster product
</td>
<td style="text-align:left;">
daily (2002-07-04 - present)
</td>
<td style="text-align:left;">
mg.m-3
</td>
<td style="text-align:left;">
extractEnv()
</td>
<td style="text-align:left;width: 30em; ">
Remotely sensed chlorophyll-a concentration (OC3 model). Derived from
the MODIS Aqua satellite mission. Multi-spectral measurements are used
to infer the concentration of chlorophyll-a, most typically due to
phytoplankton, present in the water (mg.m-3).
</td>
<td style="text-align:left;">
IMOS
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
rs_current
</td>
<td style="text-align:left;">
Composite raster product
</td>
<td style="text-align:left;">
daily (1993-01-01 - present)
</td>
<td style="text-align:left;">
ms-1; degrees
</td>
<td style="text-align:left;">
extractEnv()
</td>
<td style="text-align:left;width: 30em; ">
Gridded (adjusted) sea level anomaly (GSLA), surface geostrophic
velocity in the east-west (UCUR) and north-south (VCUR) directions for
the Australasian region derived from the IMOS Ocean Current project. Two
additional variables are calculated: surface current velocity (ms-1) and
bearing (degrees).
</td>
<td style="text-align:left;">
IMOS
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
rs_salinity
</td>
<td style="text-align:left;">
Satellite-derived raster product
</td>
<td style="text-align:left;">
weekly (2011-08-25 - 2015-06-07)
</td>
<td style="text-align:left;">
psu
</td>
<td style="text-align:left;">
extractEnv()
</td>
<td style="text-align:left;width: 30em; ">
7-day composite remotely sensed salinity. Derived from the NASA Aquarius
satellite mission (psu).
</td>
<td style="text-align:left;">
IMOS
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
rs_turbidity
</td>
<td style="text-align:left;">
Satellite-derived raster product
</td>
<td style="text-align:left;">
daily (2002-07-04 - present)
</td>
<td style="text-align:left;">
m-1
</td>
<td style="text-align:left;">
extractEnv()
</td>
<td style="text-align:left;width: 30em; ">
Diffuse attenuation coefficient at 490 nm (K490) indicates the turbidity
of the water column (m-1). The value of K490 represents the rate which
light at 490 nm is attenuated with depth. For example a K490 of
0.1/meter means that light intensity will be reduced one natural log
within 10 meters of water. Thus, for a K490 of 0.1, one attenuation
length is 10 meters. Higher K490 value means smaller attenuation depth,
and lower clarity of ocean water.
</td>
<td style="text-align:left;">
IMOS
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
rs_npp
</td>
<td style="text-align:left;">
Satellite-derived raster product
</td>
<td style="text-align:left;">
daily (2002-07-04 - present)
</td>
<td style="text-align:left;">
mgC.m_2.day-1
</td>
<td style="text-align:left;">
extractEnv()
</td>
<td style="text-align:left;width: 30em; ">
Net primary productivity (OC3 model and Eppley-VGPM algorithm). Modelled
product used to compute an estimate of the Net Primary Productivity
(NPP). The model used is based on the standard vertically generalised
production model (VGPM). The VGPM is a “chlorophyll-based” model that
estimates net primary production from chlorophyll using a
temperature-dependent description of chlorophyll-specific photosynthetic
efficiency. For the VGPM, net primary production is a function of
chlorophyll, available light, and the photosynthetic efficiency. The
only difference between the Standard VGPM and the Eppley-VGPM is the
temperature-dependent description of photosynthetic efficiencies, with
the Eppley approach using an exponential function to account for
variation in photosynthetic efficiencies due to photoacclimation.
</td>
<td style="text-align:left;">
IMOS
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
moor_sea_temp
</td>
<td style="text-align:left;">
Fixed sub-surface moorings
</td>
<td style="text-align:left;">
hourly
</td>
<td style="text-align:left;">
degrees Celcius
</td>
<td style="text-align:left;">
extractMoor()
</td>
<td style="text-align:left;width: 30em; ">
Depth-integrated in-situ, hourly time-series measurements of sea
temperature (degrees Celcius) at fixed mooring locations
</td>
<td style="text-align:left;">
IMOS
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
moor_psal
</td>
<td style="text-align:left;">
Fixed sub-surface moorings
</td>
<td style="text-align:left;">
hourly
</td>
<td style="text-align:left;">
psu
</td>
<td style="text-align:left;">
extractMoor()
</td>
<td style="text-align:left;width: 30em; ">
Depth-integrated in-situ, hourly time-series measurements of salinity
(psu) at fixed mooring locations
</td>
<td style="text-align:left;">
IMOS
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
moor_ucur
</td>
<td style="text-align:left;">
Fixed sub-surface moorings
</td>
<td style="text-align:left;">
hourly
</td>
<td style="text-align:left;">
ms-1
</td>
<td style="text-align:left;">
extractMoor()
</td>
<td style="text-align:left;width: 30em; ">
Depth-integrated in-situ, hourly time-series measurements of subsurface
geostrophic current velocity in the east-west direction (ms-1) at fixed
mooring locations
</td>
<td style="text-align:left;">
IMOS
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
moor_vcur
</td>
<td style="text-align:left;">
Fixed sub-surface moorings
</td>
<td style="text-align:left;">
hourly
</td>
<td style="text-align:left;">
ms-1
</td>
<td style="text-align:left;">
extractMoor()
</td>
<td style="text-align:left;width: 30em; ">
Depth-integrated in-situ, hourly time-series measurements of subsurface
geostrophic current velocity in the north-south direction (ms-1) at
fixed mooring locations
</td>
<td style="text-align:left;">
IMOS
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
BRAN_temp
</td>
<td style="text-align:left;">
3D Raster product
</td>
<td style="text-align:left;">
daily (1993-01-01 - 2023-12-31) - waiting for new Bluelink model
</td>
<td style="text-align:left;">
degrees Celcius
</td>
<td style="text-align:left;">
extractBlue()
</td>
<td style="text-align:left;width: 30em; ">
Water temperature at specified depth from the surface to 4,509-m depth
</td>
<td style="text-align:left;">
Bluelink (CSIRO)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
BRAN_salt
</td>
<td style="text-align:left;">
3D Raster product
</td>
<td style="text-align:left;">
daily (1993-01-01 - 2023-12-31) - waiting for new Bluelink model
</td>
<td style="text-align:left;">
psu
</td>
<td style="text-align:left;">
extractBlue()
</td>
<td style="text-align:left;width: 30em; ">
Water salinity at specified depth from the surface to 4,509-m depth
</td>
<td style="text-align:left;">
Bluelink (CSIRO)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
BRAN_cur
</td>
<td style="text-align:left;">
3D Raster product
</td>
<td style="text-align:left;">
daily (1993-01-01 - 2023-12-31) - waiting for new Bluelink model
</td>
<td style="text-align:left;">
ms-1; degrees clockwise
</td>
<td style="text-align:left;">
extractBlue()
</td>
<td style="text-align:left;width: 30em; ">
Geostrophic velocity in the east-west (UCUR) and north-south (VCUR)
directions from the surface to 4,509-m depth. Two additional variables
are calculated: current velocity (ms-1) and bearing (degrees).
</td>
<td style="text-align:left;">
Bluelink (CSIRO)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
BRAN_wcur
</td>
<td style="text-align:left;">
Raster product
</td>
<td style="text-align:left;">
daily (1993-01-01 - 2023-12-31) - waiting for new Bluelink model
</td>
<td style="text-align:left;">
ms-1
</td>
<td style="text-align:left;">
extractBlue()
</td>
<td style="text-align:left;width: 30em; ">
Vertical current speed in the water column is calculated (negative =
downwards; positive = upwards) using the layers available between the
surface to 200-m depths.
</td>
<td style="text-align:left;">
Bluelink (CSIRO)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
BRAN_ssh
</td>
<td style="text-align:left;">
Raster product
</td>
<td style="text-align:left;">
daily (1993-01-01 - 2023-12-31) - waiting for new Bluelink model
</td>
<td style="text-align:left;">
meters
</td>
<td style="text-align:left;">
extractBlue()
</td>
<td style="text-align:left;width: 30em; ">
Sea surface height at the water surface
</td>
<td style="text-align:left;">
Bluelink (CSIRO)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
BRAN_mld
</td>
<td style="text-align:left;">
Raster product
</td>
<td style="text-align:left;">
daily (1993-01-01 - 2023-12-31) - waiting for new Bluelink model
</td>
<td style="text-align:left;">
meters
</td>
<td style="text-align:left;">
extractBlue()
</td>
<td style="text-align:left;width: 30em; ">
Mixed layer depth in relation to the water surface
</td>
<td style="text-align:left;">
Bluelink (CSIRO)
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
BRAN_wind
</td>
<td style="text-align:left;">
Raster product
</td>
<td style="text-align:left;">
daily (1993-01-01 - 2023-12-31) - waiting for new Bluelink model
</td>
<td style="text-align:left;">
ms-1; degrees clockwise
</td>
<td style="text-align:left;">
extractBlue()
</td>
<td style="text-align:left;width: 30em; ">
Wind forcing at the water surface in the east-west (uwind) and
north-south (vwind) directions. Two additional variables are calculated:
wind velocity (ms-1) and bearing (degrees).
</td>
<td style="text-align:left;">
Bluelink (CSIRO)
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>In this vignette we will explore some examples for accessing and
integrating Bluelink (BRAN) data, both at depth and at the water
surface.</p>
<p><br></p>
</div>
<div class="section level2">
<h2 id="usage-of-the-extractblue-function">Usage of the <code>extractBlue()</code> function<a class="anchor" aria-label="anchor" href="#usage-of-the-extractblue-function"></a>
</h2>
<div class="section level3">
<h3 id="load-example-dataset">Load example dataset<a class="anchor" aria-label="anchor" href="#load-example-dataset"></a>
</h3>
<p>The primary function to extract and append Bluelink (BRAN) data to
telemetry data is the <code><a href="../reference/extractBlue.html">extractBlue()</a></code> function. Lets start
with a dataset that has undergone quality control (see
<code><a href="../articles/runQC.html">vignette('runQC')</a></code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/ggspatial/" class="external-link">ggspatial</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Example dataset that has undergone quality control using the `runQC()` function</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"TownsvilleReefQC"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Only retain detections flagged as 'valid' and 'likely valid' (Detection_QC 1 and 2)</span></span>
<span><span class="va">qc_data</span> <span class="op">&lt;-</span> </span>
<span>   <span class="va">TownsvilleReefQC</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">QC</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Detection_QC</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">filename</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">filename</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p>For an overview on the spatial and temporal patterns in this example
dataset please see the <a href="extractEnv.html">extractEnv()</a>
vignette.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="bluelink-bran-environmental-data-extraction">Bluelink (BRAN) environmental data extraction<a class="anchor" aria-label="anchor" href="#bluelink-bran-environmental-data-extraction"></a>
</h3>
<p>In this example, we will extract two variables; <em>water temperature
at depth (30 m)</em> and <em>surface 3D current speeds</em>.</p>
<p>Each variable will need to be accessed one at a time using the
<code><a href="../reference/extractBlue.html">extractBlue()</a></code> function. There are a few parameters within
the function that can help the user identify the variable required, and
to manage the downloaded environmental layers:</p>
<ul>
<li>
<strong>df</strong>: the data frame with the detection data</li>
<li>
<strong>X</strong>: the name of the column with longitude for each
detection</li>
<li>
<strong>Y</strong>: the name of the column with latitude for each
detection</li>
<li>
<strong>datetime</strong>: the name of the column with the
date-timestamp for each detection</li>
<li>
<strong>env_var</strong>: the name of the environmental variable to
download and append (see <code><a href="../reference/imos_variables.html">imos_variables()</a></code> for available
variables and variable names)</li>
<li>
<strong>extract_depth</strong>: since the Bluelink (BRAN) data is
3D, the user can define a specific depth of interest and the function
will obtain the environmental data at the nearest layer available. By
default, data is obtained at the water surface
(<code>extract_depth = 0</code>).</li>
<li>
<strong>cache_layers</strong>: should the extracted and processed
environmental data layers be cached within the working directory? If so,
the environmental data will be cached as a csv file in a folder
(<code>folder_name</code>) within your working directory, and named
after the environmental variable of interest.</li>
<li>
<strong>env_buffer</strong>: since each Bluelink BRAN file was
global spatial coverage, to reduce computational cost, files are cropped
to the respective area of interest before being downloaded. By default,
the minimum and maximum latitudes and logitudes will be obtained from
the Y and X columns, and buffered at 1° in each direction. This argument
allows the user to specify default values for this buffer (e.g. higher
than 1° if interested in the environmental trends outside the area of
study, such as for running species distribution models).</li>
<li>
<strong>full_timeperiod</strong>: should environmental variables
extracted for each day across full monitoring period? If set to
<code>TRUE</code> it can be time and memory consuming for long
projects</li>
</ul>
<p><br></p>
<div class="section level5">
<h5 id="running-the-function-with-full_timeperiod-true">
<em>Running the function with
<code>full_timeperiod = TRUE</code></em><a class="anchor" aria-label="anchor" href="#running-the-function-with-full_timeperiod-true"></a>
</h5>
<p>If this option is selected the <code>extractBlue</code> function will
standardize the acoustic dataset for further analyses. This option can
be very time consuming, depending on the duration of the study and
number of acoustic stations included. During standardization,
information at <em>individual level</em> will be lost, and the exported
dataset will be sorted by acoustic station (<code>station_name</code>
column) and date (<code>detection_datetime</code> column converted to
Date format). A new column <code>Detection</code> will be included, and
will comprise 1 (days with detections) and 0 (days without detections)
values:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Obtain standardized data with water temperatures at the surface:</span></span>
<span><span class="va">data_with_sst</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/extractBlue.html">extractBlue</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">qc_data</span>,</span>
<span>                X <span class="op">=</span> <span class="st">"receiver_deployment_longitude"</span>, </span>
<span>                Y <span class="op">=</span> <span class="st">"receiver_deployment_latitude"</span>, </span>
<span>                station_name <span class="op">=</span> <span class="st">"station_name"</span>,</span>
<span>                datetime <span class="op">=</span> <span class="st">"detection_datetime"</span>, </span>
<span>                env_var <span class="op">=</span> <span class="st">"BRAN_temp"</span>,</span>
<span>                extract_depth <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                full_timeperiod <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>If we have a look at this dataset it will look like this:</p>
<table class="table">
<thead><tr class="header">
<th align="left">date</th>
<th align="right">station_name</th>
<th align="right">lon</th>
<th align="right">lat</th>
<th align="right">BRAN_temp_0</th>
<th align="right">Detection</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2013-08-10</td>
<td align="right">Kelso 2</td>
<td align="right">146.991</td>
<td align="right">-18.417</td>
<td align="right">23.5647</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2013-08-11</td>
<td align="right">Kelso 2</td>
<td align="right">146.991</td>
<td align="right">-18.417</td>
<td align="right">23.5492</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2013-08-12</td>
<td align="right">Kelso 2</td>
<td align="right">146.991</td>
<td align="right">-18.417</td>
<td align="right">24.1562</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2013-08-13</td>
<td align="right">Kelso 2</td>
<td align="right">146.991</td>
<td align="right">-18.417</td>
<td align="right">24.1873</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">2013-08-14</td>
<td align="right">Kelso 2</td>
<td align="right">146.991</td>
<td align="right">-18.417</td>
<td align="right">24.1951</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">2013-08-15</td>
<td align="right">Kelso 2</td>
<td align="right">146.991</td>
<td align="right">-18.417</td>
<td align="right">24.3274</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Which means that, on (<code>2013-08-10</code>) detections were
recorded at the <code>Kelso 2</code> station
(<code>Detection = 1</code>), but not on the other days in the example
(<code>Detection = 0</code>), but temperature data at the surface
(<code>ocean_temp_0</code>) was extracted for all days.</p>
</div>
<div class="section level5">
<h5 id="water-temperature-at-depth-30-m">
<em>Water temperature at depth (30 m)</em><a class="anchor" aria-label="anchor" href="#water-temperature-at-depth-30-m"></a>
</h5>
<p>We are going to use the function to compare the water temperatures in
the study area between the surface and the 30-m depths. Let’s download
and process the Bluelink (BRAN) data at the two depths of interest:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Obtain water temperature data at the 30-m depths</span></span>
<span><span class="va">data_with_sst2</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/extractBlue.html">extractBlue</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">qc_data</span>,</span>
<span>                X <span class="op">=</span> <span class="st">"receiver_deployment_longitude"</span>, </span>
<span>                Y <span class="op">=</span> <span class="st">"receiver_deployment_latitude"</span>, </span>
<span>                station_name <span class="op">=</span> <span class="st">"station_name"</span>,</span>
<span>                datetime <span class="op">=</span> <span class="st">"detection_datetime"</span>, </span>
<span>                env_var <span class="op">=</span> <span class="st">"BRAN_temp"</span>,</span>
<span>                extract_depth <span class="op">=</span> <span class="fl">30</span>,</span>
<span>                verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                full_timeperiod <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s see how the two variables look in relation to each
other:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Station <span class="op">=</span> <span class="va">data_with_sst</span><span class="op">$</span><span class="va">station_name</span>,</span>
<span>  Date <span class="op">=</span> <span class="va">data_with_sst</span><span class="op">$</span><span class="va">date</span>,</span>
<span>  Variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Surface"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_with_sst</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Depth"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_with_sst2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Temperature <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">data_with_sst</span><span class="op">$</span><span class="va">BRAN_temp_0</span>, <span class="va">data_with_sst2</span><span class="op">$</span><span class="va">BRAN_temp_30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data_plot</span><span class="op">$</span><span class="va">Variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">data_plot</span><span class="op">$</span><span class="va">Variable</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Surface"</span>, <span class="st">"Depth"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Station</span>, y <span class="op">=</span> <span class="va">Temperature</span>, colour <span class="op">=</span> <span class="va">Variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Temperature (°C)"</span>, colour <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"Temp_surf_depth.png"</span>, units <span class="op">=</span> <span class="st">"cm"</span>, width <span class="op">=</span> <span class="fl">25</span>, height <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/bluelink/Temp_surf_depth.png" id="id" class="class" style="width:90.0%"></p>
</div>
<div class="section level5">
<h5 id="surface-3d-current-speeds">
<em>Surface 3D current speeds</em><a class="anchor" aria-label="anchor" href="#surface-3d-current-speeds"></a>
</h5>
<p>Besides from enabling users to extract environmental data at
different depths (using the <code>extract_depth</code> argument), we can
also use the <code><a href="../reference/extractBlue.html">extractBlue()</a></code> function to obtain 3D current
data along our study region. When horizontal current data is requested
(<code>env_var = BRAN_cur</code>), two new variables are calculated
(similarly, the same is done for wind data when using
<code>env_var = BRAN_wind</code>), including speed (in m/s) and
direction (degrees clockwise). When vertical current is requested (using
<code>env_var = "BRAN_wcur"</code>), a representative vertical current
value in the water column will be calculated, using the available layers
of vertical data between the water surface and 200-m depth.</p>
<p>In this example, we are going to download horizontal (speed and
direction) and vertical current data, and save the processed Bluelink
(BRAN) files for further investigation. First, let’s download the
data:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download horizontal current data:</span></span>
<span><span class="va">data_cur</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/extractBlue.html">extractBlue</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">qc_data</span>,</span>
<span>                X <span class="op">=</span> <span class="st">"receiver_deployment_longitude"</span>, </span>
<span>                Y <span class="op">=</span> <span class="st">"receiver_deployment_latitude"</span>, </span>
<span>                datetime <span class="op">=</span> <span class="st">"detection_datetime"</span>, </span>
<span>                env_var <span class="op">=</span> <span class="st">"BRAN_cur"</span>,</span>
<span>                extract_depth <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                cache_layers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                folder_name <span class="op">=</span> <span class="st">"Bluelink"</span>,</span>
<span>                verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># download vertical current data:</span></span>
<span><span class="va">data_cur</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/extractBlue.html">extractBlue</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">data_cur</span>,</span>
<span>                X <span class="op">=</span> <span class="st">"receiver_deployment_longitude"</span>, </span>
<span>                Y <span class="op">=</span> <span class="st">"receiver_deployment_latitude"</span>, </span>
<span>                datetime <span class="op">=</span> <span class="st">"detection_datetime"</span>, </span>
<span>                env_var <span class="op">=</span> <span class="st">"BRAN_wcur"</span>,</span>
<span>                extract_depth <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                cache_layers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                folder_name <span class="op">=</span> <span class="st">"Bluelink"</span>,</span>
<span>                verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>As we set <code>cache_layers</code> to <code>TRUE</code>, the
downloaded and processed files will be cached in the
<code>folder_name</code> folder within the working directory (Bluelink),
as a csv file. We can then load these processed files and plot them, to
look at the trends in current speed within the study area:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load environmental data:</span></span>
<span><span class="va">cur.hor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"Bluelink/BRAN_cur_0.csv"</span><span class="op">)</span></span>
<span><span class="va">cur.ver</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"Bluelink/BRAN_wcur_0.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot variables</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://matplotlib.org/cmocean/" class="external-link">cmocean</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mdsumner/ozmaps" class="external-link">ozmaps</a></span><span class="op">)</span></span>
<span><span class="va">oz_states</span> <span class="op">&lt;-</span> <span class="va">ozmap_states</span> <span class="co"># load Australia shapefile</span></span>
<span></span>
<span><span class="va">plot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cur.hor</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">BRAN_dir</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu">cmocean</span><span class="op">(</span><span class="st">"delta"</span><span class="op">)</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">oz_states</span>, fill <span class="op">=</span> <span class="st">"lightgray"</span>, colour <span class="op">=</span> <span class="st">"darkgray"</span>, </span>
<span>    lwd <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145.7</span>, <span class="fl">148.1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">19.7</span>, <span class="op">-</span><span class="fl">17.3</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">146</span>, <span class="fl">148</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">qc_data</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">receiver_deployment_longitude</span>, y <span class="op">=</span> <span class="va">receiver_deployment_latitude</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>, fill <span class="op">=</span> <span class="st">"Current bearing (°)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cur.hor</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">BRAN_spd</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu">cmocean</span><span class="op">(</span><span class="st">"speed"</span><span class="op">)</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">oz_states</span>, fill <span class="op">=</span> <span class="st">"lightgray"</span>, colour <span class="op">=</span> <span class="st">"darkgray"</span>, </span>
<span>    lwd <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145.7</span>, <span class="fl">148.1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">19.7</span>, <span class="op">-</span><span class="fl">17.3</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">146</span>, <span class="fl">148</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">qc_data</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">receiver_deployment_longitude</span>, y <span class="op">=</span> <span class="va">receiver_deployment_latitude</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>, fill <span class="op">=</span> <span class="st">"Current speed (m/s)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cur.ver</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">ocean_w</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu">cmocean</span><span class="op">(</span><span class="st">"balance"</span><span class="op">)</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.0005</span>, <span class="fl">0.0005</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.0005</span>, <span class="fl">0.0005</span>, <span class="fl">0.0005</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">oz_states</span>, fill <span class="op">=</span> <span class="st">"lightgray"</span>, colour <span class="op">=</span> <span class="st">"darkgray"</span>, </span>
<span>    lwd <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145.7</span>, <span class="fl">148.1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">19.7</span>, <span class="op">-</span><span class="fl">17.3</span><span class="op">)</span>, expand <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">146</span>, <span class="fl">148</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">qc_data</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">receiver_deployment_longitude</span>, y <span class="op">=</span> <span class="va">receiver_deployment_latitude</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Longitude"</span>, y <span class="op">=</span> <span class="st">"Latitude"</span>, fill <span class="op">=</span> <span class="st">"Vertical current speed (m/s)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot1</span> <span class="op">+</span> <span class="va">plot2</span> <span class="op">+</span> <span class="va">plot3</span></span></code></pre></div>
<p><img src="images/bluelink/Current_3D.png" id="id" class="class" style="width:100.0%"></p>
<p><br></p>
<hr>
<p><strong>Vignette version</strong> 0.0.1 (26 Jun 2023)</p>
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Fabrice Jaine, Ian Jonsen, Vinay Udyawer, Ross Dwyer, Kylie Scales, Francisca Maron, Xavier Hoenner, Charlie Huveneers, Yuri Niella.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
